[% TAGS [** **] %]

<div class="pod">
[** WRAPPER page/section title='SYNOPSIS' id='section_SYNOPSIS' -**]
    <pre>
      <span class="tt">[% USE mydata = datafile('/path/to/datafile') %]</span>
      <span class="tt">[% USE mydata = datafile('/path/to/datafile', delim = '|') %]</span>
      
      <span class="tt">[% FOREACH record = mydata %]</span>
         <span class="tt">[% record.this %]</span>  <span class="tt">[% record.that %]</span>
      <span class="tt">[% END %]</span>
    </pre>
[** END -**]
[** WRAPPER page/section title='DESCRIPTION' id='section_DESCRIPTION' -**]
    <p>
      This plugin provides a simple facility to construct a list of hash
      references, each of which represents a data record of known structure,
      from a data file.
    </p>
    <pre>
      <span class="tt">[% USE datafile(filename) %]</span>
    </pre>
    <p>
      A absolute filename must be specified (for this initial implementation at
      least - in a future version it might also use the
      <code>INCLUDE_PATH</code>). An optional <code>delim</code> parameter may
      also be provided to specify an alternate delimiter character.
    </p>
    <pre>
      <span class="tt">[% USE userlist = datafile('/path/to/file/users')     %]</span>
      <span class="tt">[% USE things   = datafile('items', delim = '|') %]</span>
    </pre>
    <p>
      The format of the file is intentionally simple. The first line defines
      the field names, delimited by colons with optional surrounding
      whitespace. Subsequent lines then defines records containing data items,
      also delimited by colons. e.g.
    </p>
    <pre>
      id : name : email : tel
      abw : Andy Wardley : abw@tt2.org : 555-1234
      sam : Simon Matthews : sam@tt2.org : 555-9876
    </pre>
    <p>
      Each line is read, split into composite fields, and then used to
      initialise a hash array containing the field names as relevant keys. The
      plugin returns a blessed list reference containing the hash references in
      the order as defined in the file.
    </p>
    <pre>
      <span class="tt">[% FOREACH user = userlist %]</span>
         <span class="tt">[% user.id %]</span>: <span class="tt">[% user.name %]</span>
      <span class="tt">[% END %]</span>
    </pre>
    <p>
      The first line of the file <b>must</b> contain the field definitions.
      After the first line, blank lines will be ignored, along with comment
      line which start with a '<code>#</code>'.
    </p>
[** END -**]
[** WRAPPER page/section title='BUGS' id='section_BUGS' -**]
    <p>
      Should handle file names relative to <code>INCLUDE_PATH</code>. Doesn't
      permit use of '<code>:</code>' in a field. Some escaping mechanism is
      required.
    </p>
[** END -**]
[** WRAPPER page/section title='AUTHOR' id='section_AUTHOR' -**]
    <p>
      Andy Wardley &lt;abw@wardley.org&gt; <a
      href="http://wardley.org/">http://wardley.org/</a>
    </p>
[** END -**]
[** WRAPPER page/section title='COPYRIGHT' id='section_COPYRIGHT' -**]
    <p>
      Copyright (C) 1996-2007 Andy Wardley. All Rights Reserved.
    </p>
    <p>
      This module is free software; you can redistribute it and/or modify it
      under the same terms as Perl itself.
    </p>
[** END -**]
[** WRAPPER page/section title='SEE ALSO' id='section_SEE_ALSO' -**]
    <p>
      <a href="[** ttmodlink('Template::Plugin') **]">Template::Plugin</a>
    </p>
[** END -**]

</div>
